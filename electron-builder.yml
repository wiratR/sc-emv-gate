appId: com.example.sc-emv-gate
productName: sc-emv-gate

publish: null

# ✅ รวม production deps ใน node_modules เข้าไปด้วย
files:
  - dist/**
  - dist-electron/**
  - node_modules/**           # <-- สำคัญ
  - package.json
  - '!**/*.map'
  - '!**/.*/**'               # ignore โฟลเดอร์ซ่อน
  - '!src/**'                 # ไม่ต้องแพ็ก src ถ้าไม่ใช้

directories:
  buildResources: build

asar: true
asarUnpack:
  # ✅ คลายทุกไฟล์ .node ออกจาก asar + โฟลเดอร์ของ native modules
  - '**/*.node'
  - 'node_modules/**/build/Release/*.node'
  - 'node_modules/better-sqlite3/**'
  - 'node_modules/node-pty/**'
  - '**/*.dll'                # กันเหนียวบน Windows

# ✅ ใส่ resource ที่แอปอ้างอิงตอนรัน (ถ้ามี)
extraResources:
  - from: database
    to: database
  - from: data
    to: data
  - from: config.json
    to: config.json

mac:
  category: public.app-category.utilities
  target: [dmg, zip]
  hardenedRuntime: true
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist
  gatekeeperAssess: false
  icon: build/icon.icns

dmg:
  icon: build/icon.icns

win:
  target: [nsis, zip]
  icon: build/icon.ico

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true

linux:
  target: [AppImage, deb]
  category: Utility
  icon: build/icons
  maintainer: "Siam Infinity Solution <wirat.r@sissolution.co.th>"
